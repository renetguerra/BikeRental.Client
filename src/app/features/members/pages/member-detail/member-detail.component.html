<div class="modern-member-detail">
  <div class="container">
    <div class="max-w-4xl mx-auto">
      <h1 class="page-title">Mi perfil</h1>

      <!-- Tabs Section -->
      <div class="tabs-container">
        <div class="tab-buttons">
          <button
            class="tab-button"
            [class.active]="activeTab() === 'info'"
            (click)="setActiveTab('info')">
            Informaci칩n
          </button>
          @if (hasFavorites()) {
            <button
              class="tab-button"
              [class.active]="activeTab() === 'favorites'"
              (click)="setActiveTab('favorites')">
              Bicicletas Favoritas
            </button>
          }
          @if (hasRentalHistory()) {
            <button
              class="tab-button"
              [class.active]="activeTab() === 'history'"
              (click)="setActiveTab('history')">
              Historial de Alquileres
            </button>
          }
        </div>

        <!-- Tab Content -->
        <div class="tab-content">
          <!-- Info Tab -->
          @if (activeTab() === 'info') {
            <!-- Informaci칩n Personal Card -->
            <div class="info-card">
              <h2 class="card-title">Informaci칩n Personal</h2>
              <div class="personal-details">
                <div class="detail-row">
                  <div class="detail-group">
                    <span class="detail-text">
                      <span class="detail-label">Nombre:</span>
                      <span class="detail-value">{{ member()?.knownAs || 'No especificado' }}</span>
                    </span>
                  </div>
                  <div class="detail-group">
                    <span class="detail-text">
                      <span class="detail-label">Apellido:</span>
                      <span class="detail-value">{{ member()?.surname || 'No especificado' }}</span>
                    </span>
                  </div>
                </div>
                <div class="detail-row">
                  <div class="detail-group">
                    <span class="detail-text">
                      <span class="detail-label">Correo electr칩nico:</span>
                      <span class="detail-value">{{ member()?.email || 'No especificado' }}</span>
                    </span>
                  </div>
                </div>
              </div>
              @if (user()?.roles?.includes('Admin')) {
              <div class="card-actions">
                <button class="primary-btn">Guardar cambios</button>
              </div>
              }
            </div>

            <!-- Detalles de Ubicaci칩n Card -->
            <div class="info-card">
              <h3 class="section-title">Detalles de Ubicaci칩n</h3>
              <div class="location-details">
                <div class="detail-row">
                  <div class="detail-group">
                    <span class="detail-text">
                      <span class="detail-label">Calle:</span>
                      <span class="detail-value">{{ member()?.address?.street || 'No especificado' }}</span>
                    </span>
                  </div>
                  <div class="detail-group">
                    <span class="detail-text">
                      <span class="detail-label">N칰mero:</span>
                      <span class="detail-value">{{ member()?.address?.houseNumber || 'N/A' }}</span>
                    </span>
                  </div>
                  <div class="detail-group">
                    <span class="detail-text">
                      <span class="detail-label">C칩digo Postal:</span>
                      <span class="detail-value">{{ member()?.address?.zip || 'N/A' }}</span>
                    </span>
                  </div>
                </div>
                <div class="detail-row">
                  <div class="detail-group">
                    <span class="detail-text">
                      <span class="detail-label">Ciudad:</span>
                      <span class="detail-value">{{ member()?.address?.city || 'No especificado' }}</span>
                    </span>
                  </div>
                  <div class="detail-group">
                    <span class="detail-text">
                      <span class="detail-label">Pa칤s:</span>
                      <span class="detail-value">{{ member()?.address?.country || 'No especificado' }}</span>
                    </span>
                  </div>
                </div>
              </div>
            </div>

            <!-- Datos Bancarios Card -->
            <div class="info-card">
              <h3 class="section-title">Datos Bancarios</h3>
              <div class="banking-details">
                <div class="detail-row">
                  <div class="detail-group">
                    <span class="detail-label">N칰mero de tarjeta:</span>
                    <div class="card-number-display">
                      <svg class="card-icon" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M20 4H4c-1.103 0-2 .897-2 2v12c0 1.103.897 2 2 2h16c1.103 0 2-.897 2-2V6c0-1.103-.897-2-2-2zM4 6h16v2H4V6zm16 12H4v-8h16v8z"></path>
                        <path d="M6 14h6v2H6z"></path>
                      </svg>
                      <span class="detail-value">{{ getCardNumber() }}</span>
                      <button class="reveal-btn" (click)="toggleCardNumber()" [title]="showFullCard() ? 'Ocultar n칰mero' : 'Mostrar n칰mero completo'">
                        <svg class="reveal-icon" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                          @if (showFullCard()) {
                          <path d="M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"></path>
                          } @else {
                          <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"></path>
                          }
                        </svg>
                      </button>
                    </div>
                  </div>
                  <div class="detail-group">
                    <span class="detail-label">Titular de la tarjeta:</span>
                    <span class="detail-value">{{ member()?.knownAs || 'No especificado' }}</span>
                  </div>
                </div>
                <div class="detail-row">
                  <div class="detail-group">
                    <span class="detail-label">Fecha de vencimiento:</span>
                    <span class="detail-value">MM/YY</span>
                  </div>
                  <div class="detail-group">
                    <span class="detail-label">CVC:</span>
                    <span class="detail-value">***</span>
                  </div>
                </div>
              </div>

              @if (user()?.roles?.includes('Admin')) {
              <div class="card-actions">
                <button class="primary-btn">A침adir M칠todo de Pago</button>
                <button class="secondary-btn">Ver m칠todos guardados</button>
              </div>
              }

              <div class="security-notice">
                <div class="security-icon">丘멆잺</div>
                <p class="security-text">Por tu seguridad, nunca compartiremos tus datos bancarios completos. La informaci칩n est치 encriptada y protegida.</p>
              </div>
            </div>

            <!-- Intereses y Estad칤sticas Card -->
            <div class="info-card">

              @if (member()?.introduction) {
              <div class="mb-6">
                <h4 class="section-title">Intereses</h4>
                <p class="interest-text">{{ member()?.introduction }}</p>
              </div>
              }

              <div class="member-stats">
                <div class="stat-item">
                  <span class="stat-label">Edad:</span>
                  <span class="stat-value">{{ member()?.age || 'N/A' }}</span>
                </div>
                <div class="stat-item">
                  <span class="stat-label">칔ltimo acceso:</span>
                  <span class="stat-value">{{ member()?.lastActive | timeago }}</span>
                </div>
                <div class="stat-item">
                  <span class="stat-label">Miembro desde:</span>
                  <span class="stat-value">{{ member()?.created | date : "dd MMM yyyy" }}</span>
                </div>
                @if ((presenceService.onlineUsers$ | async)?.includes(user()!.username)) {
                <div class="stat-item">
                  <span class="stat-label">Estado:</span>
                  <span class="stat-value online">游릭 En l칤nea</span>
                </div>
                }
              </div>
            </div>

          }          <!-- Favorites Tab -->
          @if (activeTab() === 'favorites') {
            <div class="info-card">
              <h3 class="section-title">Bicicletas Favoritas</h3>
              <app-bike-favorite></app-bike-favorite>
            </div>
          }

          <!-- History Tab -->
          @if (activeTab() === 'history') {
            <div class="info-card">
              <app-customer-rental-history></app-customer-rental-history>
            </div>
          }
        </div>
    </div>
  </div>
</div>

