<div class="modern-bike-detail">
  <div class="container">
    <div class="max-w-4xl mx-auto">
      <h1 class="page-title">{{ bike()?.brand }} {{ bike()?.model }}</h1>

      <!-- Tabs Section -->
      <div class="tabs-container">
        <div class="tab-buttons">
          <button
            class="tab-button"
            [class.active]="activeTab() === 'info'"
            (click)="setActiveTab('info')">
            {{ 'bikeDetail.infoTab' | transloco }}
          </button>
          @if (hasRentalHistory()) {
            <button
              class="tab-button"
              [class.active]="activeTab() === 'history'"
              (click)="setActiveTab('history')">
              {{ 'bikeDetail.historyTab' | transloco }}
            </button>
          }
        </div>

        <!-- Tab Content -->
        <div class="tab-content">
          <!-- Info Tab -->
          @if (activeTab() === 'info') {
            <!-- Bike Information Card -->
            <div class="info-card">
              <div class="card-header">
                <h2 class="card-title">{{ 'bikeDetail.cardTitle' | transloco }}</h2>
                @if (user()?.roles?.includes('Admin')) {
                  <button class="secondary-btn" (click)="editBike()">
                    <mat-icon>edit</mat-icon>
                    {{ 'bikeDetail.editInfo' | transloco }}
                  </button>
                }
              </div>

              <!-- Layout de dos columnas: Galería + Info -->
              <div class="bike-info-layout">
                <!-- Columna izquierda: Galería compacta -->
                <div class="gallery-column">
                  @if (galleryImages() && galleryImages().length > 0) {
                    <div class="mini-gallery-container">
                      <gallery [items]="galleryImages()" class="mini-gallery"></gallery>
                    </div>
                  } @else {
                    <div class="no-images-mini">
                      <mat-icon class="no-images-icon-mini">photo</mat-icon>
                      <span>{{ 'bikeDetail.mainImageOnly' | transloco }}</span>
                      @if (user()?.roles?.includes('Admin')) {
                        <button class="mini-btn" (click)="openDialogAddPhoto()">
                          <mat-icon>add</mat-icon>
                          {{ 'bikeDetail.addPhoto' | transloco }}
                        </button>
                      }
                    </div>
                  }
                </div>

                <!-- Columna derecha: Información técnica -->
                <div class="details-column">
                  <div class="bike-details-single-column">
                    <div class="detail-item">
                      <span class="detail-text">
                        <span class="detail-label">{{ 'bikeDetail.brand' | transloco }}:</span>
                        <span class="detail-value">{{ bike()?.brand || ('bikeDetail.notSpecified' | transloco) }}</span>
                      </span>
                    </div>
                    <div class="detail-item">
                      <span class="detail-text">
                        <span class="detail-label">{{ 'bikeDetail.model' | transloco }}:</span>
                        <span class="detail-value">{{ bike()?.model || ('bikeDetail.notSpecified' | transloco) }}</span>
                      </span>
                    </div>
                    <div class="detail-item">
                      <span class="detail-text">
                        <span class="detail-label">{{ 'bikeDetail.year' | transloco }}:</span>
                        <span class="detail-value">{{ bike()?.year || ('bikeDetail.nA' | transloco) }}</span>
                      </span>
                    </div>
                    <div class="detail-item">
                      <span class="detail-text">
                        <span class="detail-label">{{ 'bikeDetail.type' | transloco }}:</span>
                        <span class="detail-value">{{ bike()?.type || ('bikeDetail.notSpecified' | transloco) }}</span>
                      </span>
                    </div>
                    <div class="detail-item">
                      <span class="detail-text">
                        <span class="detail-label">{{ 'bikeDetail.pricePerDay' | transloco }}:</span>
                        <span class="detail-value price-highlight">{{ bike()?.price | currency }}</span>
                      </span>
                    </div>
                    <div class="detail-item">
                      <span class="detail-text">
                        <span class="detail-label">{{ 'bikeDetail.status' | transloco }}:</span>
                        <span class="detail-value" [class.available]="bike()?.isAvailable" [class.unavailable]="!bike()?.isAvailable">
                          <mat-icon class="status-icon">{{ bike()?.isAvailable ? 'check_circle' : 'cancel' }}</mat-icon>
                          {{ bike()?.isAvailable ? ('bikeDetail.available' | transloco) : ('bikeDetail.notAvailable' | transloco) }}
                        </span>
                      </span>
                    </div>

                    <!-- Botón de alquiler integrado -->
                    <div class="rent-action">
                      <button
                        class="primary-btn rent-btn-integrated"
                        [disabled]="!bike()?.isAvailable"
                        (click)="rentBike()">
                        <mat-icon>pedal_bike</mat-icon>
                        @if (bike()?.isAvailable) {
                          {{ 'bikeDetail.rentBike' | transloco }}
                        } @else {
                          {{ 'bikeDetail.notAvailableBtn' | transloco }}
                        }
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          }

          <!-- History Tab -->
          @if (activeTab() === 'history') {
            <div class="info-card">
              <app-bike-rental-history></app-bike-rental-history>
            </div>
          }
        </div>
      </div>
    </div>
  </div>
</div>
