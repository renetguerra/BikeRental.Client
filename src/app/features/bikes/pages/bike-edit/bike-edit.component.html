@if (!bike()) {
  <div class="text-center">
    <div class="spinner-border" role="status">
      <span class="sr-only">Loading...</span>
    </div>
    <p>Loading bike data...</p>
  </div>
} @else {
<div class="modern-bike-detail">
  <div class="container">
    <div class="max-w-4xl mx-auto">
      <h1 class="page-title">Editar Bicicleta</h1>

      @if (editForm?.dirty) {
      <div class="alert alert-info mb-4">
        <p>
          <strong>Información: </strong>Has realizado cambios. Cualquier cambio no guardado se perderá.
        </p>
      </div>
      }

      <!-- Tabs Section -->
      <div class="tabs-container">
        <!-- Tab Content -->
        <div class="tab-content">
          <!-- Info Tab -->
            <form #editForm="ngForm" id="editForm">

              <!-- Información de la Bicicleta Card -->
              <div class="info-card">
                <h2 class="card-title">Información de la Bicicleta</h2>
                <div class="bike-details">
                  <div class="detail-row">
                    <div class="detail-group">
                      <div class="detail-text">
                        <span class="detail-label">Marca:</span>
                        <input
                          type="text"
                          name="brand"
                          class="detail-input"
                          [(ngModel)]="bike()!.brand"
                          placeholder="Ingresa la marca">
                      </div>
                    </div>
                    <div class="detail-group">
                      <div class="detail-text">
                        <span class="detail-label">Modelo:</span>
                        <input
                          type="text"
                          name="model"
                          class="detail-input"
                          [(ngModel)]="bike()!.model"
                          placeholder="Ingresa el modelo">
                      </div>
                    </div>
                  </div>
                  <div class="detail-row">
                    <div class="detail-group">
                      <div class="detail-text">
                        <span class="detail-label">Tipo:</span>
                        <select
                          name="type"
                          class="detail-input"
                          [(ngModel)]="bike()!.type">
                          <option value="">Selecciona el tipo</option>
                          <option value="Mountain">Mountain</option>
                          <option value="Road">Road</option>
                          <option value="Electric">Electric</option>
                          <option value="Hybrid">Hybrid</option>
                          <option value="BMX">BMX</option>
                        </select>
                      </div>
                    </div>
                    <div class="detail-group">
                      <div class="detail-text">
                        <span class="detail-label">Año:</span>
                        <input
                          type="number"
                          name="year"
                          class="detail-input"
                          [(ngModel)]="bike()!.year"
                          placeholder="2024"
                          min="1990"
                          max="2030">
                      </div>
                    </div>
                  </div>
                  <div class="detail-row">
                    <div class="detail-group">
                      <div class="detail-text">
                        <span class="detail-label">Precio por día:</span>
                        <input
                          type="number"
                          name="price"
                          class="detail-input"
                          [(ngModel)]="bike()!.price"
                          placeholder="25.00"
                          step="0.01"
                          min="0">
                      </div>
                    </div>
                    <div class="detail-group">
                      <div class="detail-text">
                        <span class="detail-label">Disponible:</span>
                        <select
                          name="isAvailable"
                          class="detail-input"
                          [(ngModel)]="bike()!.isAvailable">
                          <option [ngValue]="true">Disponible</option>
                          <option [ngValue]="false">No disponible</option>
                        </select>
                      </div>
                    </div>
                  </div>
                  <div class="detail-row detail-row-full">
                    <div class="detail-group detail-group-full">
                      <div class="detail-text">
                        <span class="detail-label">Observaciones:</span>
                        <textarea
                          name="notes"
                          class="detail-input detail-textarea-large"
                          placeholder="Notas adicionales sobre la bicicleta..."
                          rows="4"></textarea>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Botón Save Changes para Información de la Bicicleta -->
                <div class="card-actions">
                  <button
                    type="button"
                    (click)="updateBike()"
                    class="primary-btn"
                    [disabled]="!editForm?.dirty">
                    <mat-icon>save</mat-icon>
                    Guardar Información de la Bicicleta
                  </button>
                </div>
              </div>

              <!-- Imagen Principal Card -->
              <div class="info-card">
                <h2 class="card-title">Imagen Principal</h2>
                <div class="profile-upload-section">
                  <div class="profile-avatar">
                    <img
                      [src]="bike()?.photoUrl || './assets/user.png'"
                      [alt]="bike()?.brand + ' ' + bike()?.model"
                      class="avatar-image"/>
                  </div>
                  <div class="upload-controls">
                    <button type="button" class="primary-btn" (click)="openDialogAddPhoto()">
                      <mat-icon>add_a_photo</mat-icon>
                      Gestionar Fotos
                    </button>
                    <p class="upload-hint">PNG, JPG, GIF hasta 10MB.</p>
                  </div>
                </div>
              </div>

            </form>
        </div>
      </div>
    </div>
  </div>
</div>
}
